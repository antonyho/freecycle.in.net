{{set . "title" "FreeCycle"}}
{{append . "moreStyles" "css/cover.css"}}
{{template "header.html" .}}

		<div class="site-wrapper">
		
			<div class="site-wrapper-inner">
			
				<div class="cover-container">
{{template "navigation.html" .}}

					<div class="inner">	
						<div class="alert alert-dismissable jumbotron">
							<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
							<div class="cover">
								<h1 class="cover-heading">Free to Give and Get!</h1>
								<p class="lead">Have something still usable to dump? Dumping furniture in good condition is too wasting and costs you money to dump? Why not trying to pass it to someone before throwing still usable thing? We make too much waste daily and our landfills are running out. We can reduce waste from the source!</p>
								<p class="lead">
									<a href="/App/Objectives" class="btn btn-lg btn-default">Our Objectives</a>
								</p>
							</div>
						</div>

						<table class="table table-hover table-condensed" id="itemlist">
							<caption><h2>Latest Items</h2></caption>
							<thead>
								<tr><th>Item</th><th>Handover Method</th><th>Post Date</th></tr>
							</thead>
							<tbody></tbody>
						</table>
					</div>
							
					<div class="mastfoot">
						<div class="inner">
							<p>Cover template for <a href="http://getbootstrap.com">Bootstrap</a>, by <a href="https://twitter.com/mdo">@mdo</a>.</p>
						</div>
					</div>
				
				</div>
			
			</div>
		
		</div>

		<div id="item-tooltip">
			<h5 id="item-title"></h5>(<span id="item-post-date"></span>)
			<p><span>Description:</span><br><span id="item-desc"></span></p>
			<p><span>Condition:</span><span id="item-condition"></span></p>
			<p><span>Handover Method:</span><span id="item-handover"></span></p>
			<p><span>Handover Detail:</span><span id="item-handover-detail"></span></p>
			<p><span>Owner:</span><span id="item-owner"></span></p>
			<p><span>Last Update Date:</span><span id="item-update-date"></span></p>
		</div>

		<script type="text/javascript">
			var listData;
			$(document).ready(function() {
				$("#item-tooltip").hide();
				$.post(
					'/Post/List', 
					function(data) {
						for (idx in data) {
							listData = data;
							var item = data[idx];
							var newRow = $("<tr></tr>");
							newRow.attr("data-toggle", "tooltip");
							newRow.attr("data-html", "true");
							newRow.attr("data-placement", "left");
							newRow.attr("data-index", idx);
							var newTitleCol = $("<td></td>").append(item.Title);
							var newConditionBadge = $("<span></span>");
							if (item.Condition < 100)
								newConditionBadge.addClass("badge").append(item.Condition).append("%");
							else
								newConditionBadge.addClass("label label-default").append("new");
							newTitleCol.append(newConditionBadge);

							var handling;
							switch (item.Handover) {
								case "F":
								handling = item.Location;
								break;

								case "D":
								switch (item.Delivery) {
									case "P":
									handling = "Postal";
									break;

									case "C":
									handling = "Courrier";
									break;

									default:
									handling = "Delivery"
								}
								break;
							}
							var newLocationCol = $("<td></td>").append(handling);

							var newPostDate = $("<td></td>");
							var postDate = new Date(item.PostDate * 1000);
							newPostDate.append($.datepicker.formatDate('yy-mm-dd', postDate));

							newRow.append(newTitleCol).append(newLocationCol).append(newPostDate);
							newRow.tooltip({
								title: function() {
									var idx = $(this).attr("data-index");
									var thisItem = listData[idx];
									var htmlContent = $("#item-tooltip");
									$("#item-title").text(thisItem.Title);
									$("#item-desc").text(thisItem.Description);
									$("#item-post-date").text($.datepicker.formatDate('yy-mm-dd', new Date(thisItem.PostDate * 1000)));
									if (thisItem.Condition == 100)
										$("#item-condition").text("new");
									else
										$("#item-condition").text(thisItem.Condition + "%");
									var handoverMethod;
									var handoverDetail;
									switch (thisItem.Handover) {
										case "F":
										handoverMethod = "Transition in face to face";
										handoverDetail = thisItem.Location;
										break;

										case "D":
										handoverMethod = "Delivery";
										switch (thisItem.Delivery) {
											case "P":
											handoverDetail = "Delivery by postal service";
											break;

											case "C":
											handoverDetail = "Delivery by courrier";
											break;
										}
										break;

									}
									$("#item-handover").text(handoverMethod);
									$("#item-handover-detail").text(handoverDetail);

									$("#item-owner").text(thisItem.Contact);
									$("#item-update-date").text($.datepicker.formatDate('yy-mm-dd', new Date(thisItem.UpdateDate * 1000)));


									return htmlContent.show();
								}
							});
							$("#itemlist > tbody").append(newRow);
						}
					}, 
					'json');
			});
		</script>

{{template "footer.html" .}}
